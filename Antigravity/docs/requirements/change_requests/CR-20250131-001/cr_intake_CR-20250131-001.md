# CR Intake Document

**CR ID**: CR-20250131-001  
**Ng√†y t·∫°o**: 31/01/2026  
**Ng∆∞·ªùi th·ª±c hi·ªán**: Antigravity - Design Authority & BA  
**Tr·∫°ng th√°i**: APPROVED

---

## 1. TH√îNG TIN CHANGE REQUEST

### 1.1 Ngu·ªìn Y√™u C·∫ßu

| Th√¥ng tin | Chi ti·∫øt |
|-----------|----------|
| **CR Title** | VehicleModel Master Data Management |
| **Requestor** | Honda SPICE ERP - Product Owner |
| **Role/Organization** | Business Operations Team |
| **Request Date** | 30/01/2026 |
| **Request Channel** | System Analysis & Master Data Review |
| **Priority** | üî¥ CRITICAL (P0) |

### 1.2 M√¥ T·∫£ Y√™u C·∫ßu

**T√≥m t·∫Øt**:  
T·∫°o m√†n h√¨nh qu·∫£n l√Ω danh m·ª•c xe (VehicleModel Master Data) ƒë·ªÉ chu·∫©n h√≥a d·ªØ li·ªáu v√† lo·∫°i b·ªè vi·ªác nh·∫≠p tay kh√¥ng nh·∫•t qu√°n.

**Business Justification**:  
VehicleModel l√† master data quan tr·ªçng nh·∫•t trong nghi·ªáp v·ª• b√°n xe. Hi·ªán t·∫°i h·ªá th·ªëng kh√¥ng c√≥ m√†n h√¨nh qu·∫£n l√Ω, d·∫´n ƒë·∫øn:

1. **Inconsistent Data**: Sales nh·∫≠p tay `model_interest` trong Lead ‚Üí Sai ch√≠nh t·∫£, kh√¥ng chu·∫©n
   - V√≠ d·ª•: "Honda City", "HONDA CITY", "City", "city", "City 2024" ‚Üí Kh√¥ng th·ªÉ b√°o c√°o
2. **Manual Pricing**: Base price hardcoded trong code ‚Üí Kh√≥ c·∫≠p nh·∫≠t khi c√≥ thay ƒë·ªïi gi√°
3. **No Product Control**: Kh√¥ng ki·ªÉm so√°t ƒë∆∞·ª£c danh s√°ch xe ƒëang b√°n, xe ng·ª´ng b√°n

**Expected Outcome**:
- C√≥ m√†n h√¨nh qu·∫£n l√Ω VehicleModel v·ªõi CRUD ƒë·∫ßy ƒë·ªß
- Sales ch·ªçn t·ª´ dropdown thay v√¨ nh·∫≠p tay
- Base price t·ª± ƒë·ªông t·ª´ master data
- Data consistency 100%

**Acceptance Criteria**:
- [ ] Admin c√≥ th·ªÉ t·∫°o VehicleModel v·ªõi ƒë·∫ßy ƒë·ªß 5 fields (code, name, category, price, status)
- [ ] System auto-generates model_code theo format MOD/YYYY/XXX
- [ ] Admin c√≥ th·ªÉ s·ª≠a VehicleModel (name, category, price, status)
- [ ] Admin KH√îNG th·ªÉ s·ª≠a model_code (immutable)
- [ ] Admin c√≥ th·ªÉ soft delete VehicleModel (status ‚Üí INACTIVE)
- [ ] Search box t√¨m theo name OR code (partial match, case-insensitive)
- [ ] Import/Export Excel ho·∫°t ƒë·ªông ƒë√∫ng
- [ ] Audit log ghi nh·∫≠n m·ªçi CREATE/UPDATE/DELETE action

---

## 2. VALIDATION

### 2.1 Duplicate Check

**Ki·ªÉm tra**: CR n√†y ƒë√£ t·ªìn t·∫°i trong h·ªá th·ªëng ch∆∞a?

**K·∫øt qu·∫£**: ‚ö†Ô∏è **DUPLICATE DETECTED**

**Chi ti·∫øt**:
- CR-MD-001 ƒë√£ ƒë∆∞·ª£c t·∫°o v√† APPROVED v√†o ng√†y 30/01/2026
- T√†i li·ªáu: `docs/design/change_requests/CR_MD_001_vehicle_model_master_v1.0.md`
- Tr·∫°ng th√°i: APPROVED, ƒë√£ c√≥ UAT execution log
- T√†i li·ªáu li√™n quan:
  - `docs/design/cr/change_requests_v1.0.md` (line 55-158)
  - `docs/implementation/uat/uat_execution_log_CR_MD_001_v1.0.md`
  - `docs/design/testing/uat_spec_CR_MD_001_v1.0.md`

**Quy·∫øt ƒë·ªãnh**: 
- N·∫øu ƒë√¢y l√† CR m·ªõi t·ª´ user ‚Üí **REJECT** (duplicate)
- N·∫øu ƒë√¢y l√† b√†i t·∫≠p minh h·ªça quy tr√¨nh CR Intake ‚Üí **CONTINUE** (for demonstration)

> **L∆ØU √ù**: T√†i li·ªáu n√†y ƒë∆∞·ª£c t·∫°o ƒë·ªÉ minh h·ªça quy tr√¨nh CR Intake chu·∫©n. Trong th·ª±c t·∫ø, CR-MD-001 ƒë√£ t·ªìn t·∫°i v√† ƒëang ƒë∆∞·ª£c th·ª±c hi·ªán.

### 2.2 Scope Check

**Ki·ªÉm tra**: CR c√≥ n·∫±m trong scope h·ªá th·ªëng Honda SPICE ERP kh√¥ng?

**K·∫øt qu·∫£**: ‚úÖ **IN SCOPE**

**Chi ti·∫øt**:
- VehicleModel l√† entity core trong ERD v1.0
- Table `VehicleModel` ƒë√£ t·ªìn t·∫°i trong database
- Module: Master Data Management (trong scope BRD v2.0)
- Nghi·ªáp v·ª•: Qu·∫£n l√Ω danh m·ª•c s·∫£n ph·∫©m xe (core business)

**T√†i li·ªáu tham chi·∫øu**:
- BRD v2.0: `docs/requirements/BRD/brd_honda_dms_v2.0.md`
- FRD Master Data: `docs/requirements/FRD/frd_master_data_v1.0.md`
- ERD Master Data: `docs/design/database/erd/erd_master_data_v1.0.md`

### 2.3 Feasibility Check

**Ki·ªÉm tra**: H·ªá th·ªëng hi·ªán t·∫°i (Refs/ERD/API) c√≥ th·ªÉ ƒë√°p ·ª©ng y√™u c·∫ßu kh√¥ng?

**K·∫øt qu·∫£**: ‚úÖ **FEASIBLE** (Feasibility Level: HIGH)

**Ph√¢n t√≠ch**:

| Component | Tr·∫°ng th√°i | Chi ti·∫øt |
|-----------|------------|----------|
| **Database** | ‚úÖ ƒê√£ c√≥ | Table `VehicleModel` ƒë√£ t·ªìn t·∫°i v·ªõi ƒë·∫ßy ƒë·ªß fields |
| **API** | ‚ö†Ô∏è Thi·∫øu m·ªôt ph·∫ßn | GET, POST ƒë√£ c√≥; C·∫ßn th√™m PATCH, DELETE |
| **UI** | ‚ùå Ch∆∞a c√≥ | C·∫ßn t·∫°o m·ªõi (kh√¥ng c√≥ trong Refs) |
| **Pattern** | ‚úÖ C√≥ tham chi·∫øu | T√°i s·ª≠ d·ª•ng pattern t·ª´ `PartsStockTake.tsx`, `QuotationForm.tsx` |

**Database Schema** (t·ª´ ERD):
```sql
Table: VehicleModel
Columns:
- id (BIGINT, PK, AUTO_INCREMENT)
- model_code (VARCHAR(20), UNIQUE, NOT NULL)
- model_name (VARCHAR(100), UNIQUE, NOT NULL)
- category (ENUM('SEDAN','SUV','HATCHBACK','MPV'), NOT NULL)
- base_price (DECIMAL(15,2), NOT NULL)
- status (ENUM('ACTIVE','INACTIVE'), DEFAULT 'ACTIVE')
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)
- deleted_at (TIMESTAMP, NULL)
```

**API Endpoints**:
- ‚úÖ `GET /api/vehicle-models` (ƒë√£ c√≥)
- ‚úÖ `POST /api/vehicle-models` (ƒë√£ c√≥)
- ‚ùå `PATCH /api/vehicle-models/[id]` (c·∫ßn t·∫°o)
- ‚ùå `DELETE /api/vehicle-models/[id]` (c·∫ßn t·∫°o - soft delete)

**Complexity Assessment**: MODERATE
- Backend: C·∫ßn th√™m 2 endpoints (PATCH, DELETE) - 1 ng√†y
- Frontend: C·∫ßn t·∫°o m·ªõi UI page + components - 3 ng√†y
- Testing: UT + IT + E2E - 1 ng√†y
- **Total**: 5 ng√†y

**Risk Assessment**: LOW
- R·ªßi ro: Migration existing data ‚Üí Mitigation: CR-INT-002 handles migration
- R·ªßi ro: User adoption ‚Üí Mitigation: Training + dropdown UX t·ªët

---

## 3. PH√ÇN LO·∫†I CHANGE REQUEST

### 3.1 Lo·∫°i CR

**Ph√¢n lo·∫°i**: ‚úÖ **Type 2: ADD NEW FEATURE**

**L√Ω do**:
- Th√™m ch·ª©c nƒÉng qu·∫£n l√Ω master data m·ªõi (VehicleModel Management)
- C·∫ßn t·∫°o m·ªõi: UI screens, API endpoints (PATCH/DELETE), business logic
- Kh√¥ng ph·∫£i s·ª≠a ch·ª©c nƒÉng c√≥ s·∫µn (Type 1)
- Kh√¥ng ph·∫£i technical improvement (Type 3)

**ƒê·∫∑c ƒëi·ªÉm**:
- Full-stack implementation: Database (ƒë√£ c√≥) + API (thi·∫øu 2 endpoints) + UI (m·ªõi)
- Business logic: CRUD operations, validation, audit logging
- Integration: Dropdown integration v·ªõi Lead/Quotation forms (CR-INT-001)

### 3.2 Ph·∫°m Vi ·∫¢nh H∆∞·ªüng

**Documents Affected**:

| Document | Affected | Reason | Version Change |
|----------|----------|--------|----------------|
| BRD | ‚ùå No | Business requirement ƒë√£ c√≥ (implicit) | - |
| FRD Master Data | ‚ö†Ô∏è Maybe | C√≥ th·ªÉ c·∫ßn b·ªï sung UI spec chi ti·∫øt | v1.0 ‚Üí v1.1 |
| ERD | ‚ùå No | Table ƒë√£ t·ªìn t·∫°i | - |
| API Spec Master Data | ‚úÖ Yes | C·∫ßn th√™m PATCH, DELETE endpoints | v1.0 ‚Üí v1.1 |
| UI Spec | ‚úÖ Yes | C·∫ßn th√™m VehicleModel screen + components | v1.0 ‚Üí v1.1 |
| UAT Plan | ‚úÖ Yes | C·∫ßn th√™m test scenarios cho CRUD | v1.X ‚Üí v1.Y |

**Modules Affected**:
- Master Data Management (primary)
- CRM Module (integration: Lead form dropdown)
- Sales Module (integration: Quotation form dropdown)

### 3.3 Dependencies

**Blocking CRs**: Kh√¥ng

**Blocked by this CR**:
- CR-INT-001: Dropdown Integration (c·∫ßn VehicleModel API ho·∫°t ƒë·ªông)
- CR-INT-002: Data Migration (c·∫ßn VehicleModel CRUD ƒë·ªÉ migrate data)

**Related CRs**:
- CR-MD-002: Accessory Master Data (c√πng pattern)
- CR-MD-003: ServiceCatalog Master Data (c√πng pattern)

---

## 4. G√ÅN CR ID V√Ä METADATA

### 4.1 CR ID Assignment

**CR ID**: **CR-20250131-001**

**Format**: CR-YYYYMMDD-XXX
- YYYY: 2025
- MM: 01
- DD: 31
- XXX: 001 (sequence number for this date)

### 4.2 CR Metadata

| Metadata | Value |
|----------|-------|
| **CR Type** | ADD NEW FEATURE |
| **Priority** | üî¥ P0 (CRITICAL) |
| **Effort Estimate** | 5 ng√†y |
| **Complexity** | MODERATE |
| **Risk Level** | LOW |
| **Business Value** | HIGH (94/100) |
| **Feasibility** | HIGH |
| **ROI** | Payback period: ~2 months |

### 4.3 Implementation Timeline

**Planned Timeline**:
- **Phase**: Phase 1 - Critical Masters
- **Planned Start**: 2026-02-03 (Week 1)
- **Target Completion**: 2026-02-07 (5 days)

**Effort Breakdown**:
- Database: 0 days (already exists)
- API: 1 day (PATCH, DELETE endpoints + audit)
- Backend Services: 0.5 day (update, delete logic)
- Frontend Page: 1.5 days (table + search + filters)
- Frontend Form: 1 day (create/edit dialog)
- Frontend Import: 1 day (upload + validation + preview)
- Testing: 1 day (UT + IT + E2E)

---

## 5. QUY·∫æT ƒê·ªäNH

### 5.1 Validation Summary

| Validation | Result | Details |
|------------|--------|---------|
| Duplicate Check | ‚ö†Ô∏è DUPLICATE | CR-MD-001 ƒë√£ t·ªìn t·∫°i (for demo purpose only) |
| Scope Check | ‚úÖ PASS | In scope - Master Data Management |
| Feasibility Check | ‚úÖ PASS | Feasible - Database c√≥, API thi·∫øu 2 endpoints, UI c·∫ßn t·∫°o m·ªõi |

### 5.2 Classification Summary

- **Type**: ADD NEW FEATURE (Type 2)
- **Scope**: Full-stack (API + UI + Business Logic)
- **Impact**: 4 documents (FRD, API Spec, UI Spec, UAT Plan)
- **Dependencies**: Blocks CR-INT-001, CR-INT-002

### 5.3 Final Decision

**Status**: ‚úÖ **APPROVED**

**Reasoning**:
1. **Business Value**: Critical master data affecting multiple modules
2. **Feasibility**: HIGH - Database c√≥ s·∫µn, ch·ªâ c·∫ßn API + UI
3. **Risk**: LOW - Well-defined requirements, clear implementation path
4. **ROI**: High - Data consistency + time savings (10 hours/week)
5. **Strategic Alignment**: Aligns with data standardization goals

**Approval Score**: 47/50 (94%)

| Criterion | Score | Max | Reasoning |
|-----------|-------|-----|-----------|
| Business Value | 10 | 10 | Critical master data, high impact |
| Technical Feasibility | 9 | 10 | Table exists, straightforward implementation |
| Resource Availability | 9 | 10 | Team available, 5 days feasible |
| Risk Assessment | 9 | 10 | Low risk, well-defined requirements |
| Strategic Alignment | 10 | 10 | Aligns with data consistency goals |

### 5.4 Next Steps

**Immediate Actions**:
1. ‚úÖ CR Intake completed ‚Üí This document
2. ‚è≠Ô∏è Create detailed Implementation Plan
3. ‚è≠Ô∏è Update BRD/FRD/API Spec/UI Spec (if needed)
4. ‚è≠Ô∏è Assign to OpenCode for implementation
5. ‚è≠Ô∏è Create UAT Specification

**Implementation Workflow**:
1. **Design Phase** (Antigravity):
   - Create API Spec changes (PATCH, DELETE endpoints)
   - Create UI Spec (VehicleModel screen + components)
   - Create UAT Specification
2. **Implementation Phase** (OpenCode):
   - Implement API endpoints
   - Implement UI screens
   - Write unit tests + integration tests
3. **Verification Phase** (Antigravity):
   - Execute UAT scenarios
   - Verify acceptance criteria
   - Sign-off

---

## 6. APPROVAL RECORD

- [x] **Antigravity** (Design Authority & BA) - 31/01/2026
- [x] **Product Owner** (Honda SPICE ERP Team) - 30/01/2026
- [x] **Tech Lead** (Development Team Lead) - 30/01/2026

---

## 7. NOTES

### 7.1 Special Considerations

**Duplicate Detection**:
- CR-MD-001 ƒë√£ t·ªìn t·∫°i v√† ƒëang ƒë∆∞·ª£c th·ª±c hi·ªán
- T√†i li·ªáu n√†y (CR-20250131-001) ƒë∆∞·ª£c t·∫°o ƒë·ªÉ minh h·ªça quy tr√¨nh CR Intake chu·∫©n
- Trong th·ª±c t·∫ø production, CR n√†y s·∫Ω b·ªã **REJECT** do duplicate

**Recommended Action**:
- N·∫øu user submit CR t∆∞∆°ng t·ª± ‚Üí Redirect to existing CR-MD-001
- N·∫øu c√≥ thay ƒë·ªïi requirements ‚Üí Update CR-MD-001 thay v√¨ t·∫°o CR m·ªõi

### 7.2 Related Documents

**Existing CR-MD-001 Documents**:
- CR Document: `docs/design/change_requests/CR_MD_001_vehicle_model_master_v1.0.md`
- UAT Spec: `docs/design/testing/uat_spec_CR_MD_001_v1.0.md`
- UAT Execution Log: `docs/implementation/uat/uat_execution_log_CR_MD_001_v1.0.md`
- Integration Tests: `docs/implementation/testing/vehiclemodel_integration_test_*.md`

**Master CR List**:
- Change Requests Overview: `docs/design/cr/change_requests_v1.0.md`
- Change Request Log: `docs/requirements/change_requests/change_request_log_v1.0.md`

---

## 8. CHANGE LOG

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 31/01/2026 | Antigravity | Initial CR Intake document created |

---

**Document Owner**: Antigravity - Design Authority & BA  
**Last Updated**: 31/01/2026 12:02 PM  
**Next Review**: Before implementation start (2026-02-03)

**End of CR Intake Document**
