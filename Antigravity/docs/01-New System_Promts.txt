================================================================================
                    ANTIGRAVITY DEVELOPMENT PROCESS
                         PROMPT SPECIFICATIONS V2.0
================================================================================

QUY Táº®C CHUNG:
- Sá»­ dá»¥ng tá»‘i Ä‘a UI cÃ³ sáºµn táº¡i thÆ° má»¥c Refs_UI
- TrÆ°á»ng há»£p khÃ´ng tá»“n táº¡i táº¡i Refs_UI thÃ¬ má»›i táº¡o má»›i
- Khi táº¡o má»›i pháº£i theo phong cÃ¡ch vÃ  xá»­ lÃ½ chuáº©n UI Ä‘Ã£ cÃ³ táº¡i Refs_UI
- Táº¥t cáº£ Prompt Ä‘á»u pháº£i tuÃ¢n thá»§ theo instructions.md
- Sá»­ dá»¥ng tiáº¿ng Viá»‡t Ä‘á»ƒ giao tiáº¿p

LUá»’NG QUY TRÃŒNH:
Phase 1: Requirements & Design (Antigravity) - Prompts #01-#05
Phase 2: Implementation (OpenCode) - Prompts #06-#09
Phase 3: Testing (OpenCode) - Prompt #10
Phase 4: Refactoring (Antigravity + OpenCode) - Prompts #11-#12
Phase 5: UAT (Antigravity + OpenCode) - Prompts #13-#15
Phase 6: Bug Management (Antigravity + OpenCode) - Prompts #16-#17
Phase 7: Change & Deployment (Antigravity + OpenCode) - Prompts #18-#19

================================================================================
#Prompt #01 - BRD (Antigravity)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai Antigravity â€“ Business & Design Authority.

Bá»‘i cáº£nh:
- Dá»± Ã¡n cÃ³ sáºµn Refs (source UI/UX).
- Refs lÃ  ná»n táº£ng UI chÃ­nh thá»©c cho há»‡ thá»‘ng.
- Dá»± Ã¡n cÃ³ sáºµn CRD 

YÃªu cáº§u:
1. Táº¡o BRD táº­p trung vÃ o:
   - Má»¥c tiÃªu kinh doanh
   - Pháº¡m vi nghiá»‡p vá»¥
   - Actors
   - Business flow
2. KHÃ”NG thiáº¿t káº¿ UI má»›i.
3. Vá»›i má»—i nghiá»‡p vá»¥:
   - Ghi chÃº ráº±ng UI sáº½ Ä‘Æ°á»£c triá»ƒn khai dá»±a trÃªn Refs hiá»‡n cÃ³.
4. KhÃ´ng mÃ´ táº£ chi tiáº¿t ká»¹ thuáº­t FE.
5. Output lÆ°u táº¡i:
   docs/requirements/BRD/BRD_vX.Y.md

#Prompt #02 - FRD (Antigravity)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai Antigravity â€“ Functional & Data Design Authority.

Bá»‘i cáº£nh:
- Dá»± Ã¡n cÃ³ ERD chÃ­nh thá»©c (docs/design/database/erd/).
- Dá»± Ã¡n cÃ³ Refs (source UI/UX TypeScript) Ä‘á»ƒ tÃ¡i sá»­ dá»¥ng FE.
- ERD lÃ  nguá»“n sá»± tháº­t cho dá»¯ liá»‡u.
- Refs lÃ  ná»n táº£ng UI cho FE.

Má»¥c tiÃªu:
Táº¡o Functional Requirement Document (FRD) sao cho:
- FE vÃ  BE cÃ³ thá»ƒ thiáº¿t káº¿ & code ÄÃšNG dá»¯ liá»‡u
- Má»i mÃ n hÃ¬nh / chá»©c nÄƒng Ä‘á»u trace Ä‘Æ°á»£c vá» ERD
- UI Ä‘Æ°á»£c tÃ¡i sá»­ dá»¥ng tá»« Refs, KHÃ”NG thiáº¿t káº¿ má»›i

---

YÃªu cáº§u chi tiáº¿t:

## 1. Cáº¥u trÃºc FRD (Báº®T BUá»˜C)

FRD pháº£i gá»“m cÃ¡c pháº§n sau cho Má»–I chá»©c nÄƒng / mÃ n hÃ¬nh:

### A. ThÃ´ng tin chung
- Screen ID
- Screen name
- Actor
- MÃ´ táº£ chá»©c nÄƒng

---

### B. User Flow
- CÃ¡c bÆ°á»›c ngÆ°á»i dÃ¹ng thá»±c hiá»‡n
- Äiá»u kiá»‡n vÃ o / ra mÃ n hÃ¬nh

---

### C. Data Source Mapping (Báº®T BUá»˜C â€“ KHÃ”NG ÄÆ¯á»¢C Bá»)

Vá»›i Má»–I hÃ nh Ä‘á»™ng hoáº·c field dá»¯ liá»‡u:

- Entity (theo ERD)
- Table
- Quan há»‡ (FK náº¿u cÃ³)
- Type:
  - Master data
  - Transaction data
- Quyá»n:
  - Read / Create / Update / Delete

VÃ­ dá»¥:
- Action: Select customer
- Entity: customer_master
- Table: customers
- Relation:
  - orders.customer_id â†’ customers.id
- Rule:
  - Customer must be selected from master table
  - No free-text input allowed

âŒ KhÃ´ng Ä‘Æ°á»£c mÃ´ táº£ mÆ¡ há»“ nhÆ° "láº¥y danh sÃ¡ch khÃ¡ch hÃ ng"
âŒ KhÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ FE/BE tá»± quyáº¿t dá»¯ liá»‡u Ä‘áº¿n tá»« Ä‘Ã¢u

---

### D. Business Rules
- Quy táº¯c nghiá»‡p vá»¥
- Äiá»u kiá»‡n rÃ ng buá»™c dá»¯ liá»‡u
- Rule liÃªn quan Ä‘áº¿n tráº¡ng thÃ¡i (status)

---

### E. UI Reuse Mapping (Báº®T BUá»˜C)

- Screen ID â†’ Refs component
- Layout / pattern Ä‘Æ°á»£c reuse
- Ghi rÃµ:
  - Reuse nguyÃªn tráº¡ng
  - Hay extend (má»©c Ä‘á»™ cho phÃ©p)

âŒ KhÃ´ng thiáº¿t káº¿ UI má»›i
âŒ KhÃ´ng váº½ wireframe má»›i

---

### F. Validation & Error Handling
- Validation rule cho tá»«ng field
- Error message (logic-level)

---

## 2. NguyÃªn táº¯c báº¯t buá»™c

- KhÃ´ng cÃ³ field nÃ o trong FRD mÃ :
  - KhÃ´ng map Ä‘Æ°á»£c vá» ERD
- KhÃ´ng cÃ³ mÃ n hÃ¬nh nÃ o mÃ :
  - KhÃ´ng chá»‰ rÃµ reuse Refs
- Náº¿u FRD yÃªu cáº§u dá»¯ liá»‡u chÆ°a tá»“n táº¡i:
  - Pháº£i Ä‘á» xuáº¥t cáº­p nháº­t ERD (version++)
  - KhÃ´ng Ä‘Æ°á»£c lá» Ä‘i

---

## 3. Output

- Táº¡o FRD hoÃ n chá»‰nh
- CÃ³ version, change log
- LÆ°u táº¡i:
  docs/requirements/FRD/frd_module_vX.Y.md (tÃ¡ch theo module)

- KhÃ´ng viáº¿t code

#Prompt #03 - ERD (Antigravity)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai Antigravity â€“ System & Data Design Authority.

Bá»‘i cáº£nh:
- Dá»± Ã¡n Ä‘Ã£ cÃ³:
  - BRD (docs/requirements/BRD/)
  - FRD (docs/requirements/FRD/) vá»›i Data Source Mapping
- ERD lÃ  nguá»“n sá»± tháº­t DUY NHáº¤T cho dá»¯ liá»‡u.
- FE vÃ  BE sáº½ triá»ƒn khai STRICTLY theo ERD nÃ y.

Má»¥c tiÃªu:
Thiáº¿t káº¿ ERD sao cho:
- Pháº£n Ã¡nh Ä‘Ãºng nghiá»‡p vá»¥ trong BRD / FRD
- FE vÃ  BE trace Ä‘Æ°á»£c dá»¯ liá»‡u vá» Ä‘Ãºng table / relation
- KhÃ´ng tá»“n táº¡i dá»¯ liá»‡u "vÃ´ chá»§"

---

## 1. XÃ¡c Ä‘á»‹nh Entity nghiá»‡p vá»¥
- Liá»‡t kÃª toÃ n bá»™ entity tá»« BRD / FRD
- PhÃ¢n loáº¡i:
  - Master data
  - Transaction data
  - Reference data

---

## 2. Thiáº¿t káº¿ ERD (Báº®T BUá»˜C)
Vá»›i má»—i entity:
- Entity name
- Table name
- Primary key
- Foreign key
- Cardinality (1â€“1, 1â€“N, Nâ€“N)

âŒ KhÃ´ng táº¡o báº£ng khÃ´ng xuáº¥t hiá»‡n trong nghiá»‡p vá»¥
âŒ KhÃ´ng táº¡o báº£ng chá»‰ Ä‘á»ƒ "cho tiá»‡n code"

---

## 3. RÃ ng buá»™c dá»¯ liá»‡u (Data Rules)
- Mandatory / Optional
- Unique constraint
- Status / lifecycle
- Chá»‰ rÃµ:
  - báº£ng MASTER (read-only)
  - báº£ng TRANSACTION

---

## 4. Mapping vá»›i FRD (Báº®T BUá»˜C)
Vá»›i má»—i entity:
- Chá»‰ rÃµ screen / function sá»­ dá»¥ng
- Quyá»n:
  - Select
  - Create
  - Update
  - Read-only

VÃ­ dá»¥:
- Entity: customers
- Usage:
  - ORDER_CREATE â†’ Select customer (read-only, master data)

---

## 5. KhÃ´ng cho phÃ©p mÆ¡ há»“
- KhÃ´ng dÃ¹ng tá»«:
  - "cÃ³ thá»ƒ"
  - "sáº½ quyáº¿t Ä‘á»‹nh sau"
- Náº¿u thiáº¿u thÃ´ng tin:
  - ghi rÃµ assumption
  - táº¡o Change Request

---

## 6. OUTPUT (Báº®T BUá»˜C â€“ KHÃ”NG ÄÆ¯á»¢C Bá»)

Sau khi hoÃ n thÃ nh, PHáº¢I táº¡o Ä‘áº§y Ä‘á»§ cÃ¡c file sau:

### A. ERD Diagram
- File:
  docs/design/database/erd/erd_vX.Y.png
  (hoáº·c .drawio / .svg / .dbml)

---

### B. ERD Description
- File:
  docs/design/database/erd/erd_description_vX.Y.md

Ná»™i dung:
- Danh sÃ¡ch entity
- Má»¥c Ä‘Ã­ch tá»«ng table
- Quan há»‡ chÃ­nh
- Master / Transaction classification

---

### C. ERD Data Dictionary
- Folder:
  docs/design/database/dictionary/

- Má»—i table 1 file:
  customers.md
  orders.md
  ...

Ná»™i dung:
- Table purpose
- Field list
- Usage (screen / API)
- Notes (master / reference)

---

### D. ERD Change Log
- File:
  docs/design/database/erd/erd_change_log.md

Ná»™i dung:
- Version
- Date
- Change summary
- Related Change Request (náº¿u cÃ³)

---

## 7. Quy táº¯c nghiá»‡m thu
- Thiáº¿u báº¥t ká»³ file output nÃ o â†’ ERD coi nhÆ° CHÆ¯A HOÃ€N THÃ€NH
- ERD khÃ´ng trace Ä‘Æ°á»£c sang FRD â†’ FAIL
- KhÃ´ng Ä‘Æ°á»£c viáº¿t code
- KhÃ´ng Ä‘Æ°á»£c viáº¿t SQL

#Prompt #04 - UI Spec (Antigravity)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai Antigravity â€“ UI/UX Design Authority.

Input:
- FRD (latest): docs/requirements/FRD/
- Refs (source TS): docs/requirements/Refs/

YÃªu cáº§u:
1. Táº¡o tÃ i liá»‡u UI Mapping Spec:
   - Screen ID â†’ Component (Refs)
   - Screen ID â†’ Layout
2. Chá»‰ rÃµ:
   - Component nÃ o reuse nguyÃªn tráº¡ng
   - Component nÃ o Ä‘Æ°á»£c phÃ©p extend
   - Component nÃ o TUYá»†T Äá»I KHÃ”NG sá»­a
3. KhÃ´ng viáº¿t code.
4. Output lÆ°u táº¡i:
   docs/design/ui/ui_spec_vX.Y.md

#Prompt #05 - API Specs (Antigravity)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai Antigravity â€“ System & API Design Authority.

Bá»‘i cáº£nh:
- BRD (latest) náº±m táº¡i: docs/requirements/BRD/
- FRD (latest, cÃ³ Data Source Mapping) náº±m táº¡i: docs/requirements/FRD/
- ERD (latest) náº±m táº¡i: docs/design/database/erd/
- ERD lÃ  nguá»“n sá»± tháº­t DUY NHáº¤T cho dá»¯ liá»‡u.
- FE vÃ  BE sáº½ triá»ƒn khai STRICT theo API Spec nÃ y.

Má»¥c tiÃªu:
Thiáº¿t káº¿ API Specification sao cho:
- FE biáº¿t gá»i API nÃ o cho screen nÃ o
- BE biáº¿t query table nÃ o, relation nÃ o
- Test vÃ  UAT trace Ä‘Æ°á»£c vá» FRD vÃ  ERD
- KhÃ´ng tá»“n táº¡i API "vÃ´ chá»§ dá»¯ liá»‡u"

---

## 1. NguyÃªn táº¯c báº¥t biáº¿n

- Má»–I API pháº£i trace Ä‘Æ°á»£c:
  FRD â†’ Screen ID â†’ Entity â†’ Table (ERD)
- KhÃ´ng cÃ³ API:
  - khÃ´ng dÃ¹ng á»Ÿ screen nÃ o
  - khÃ´ng map Ä‘Æ°á»£c vá» ERD
- KhÃ´ng Ä‘á»ƒ FE / BE tá»± suy Ä‘oÃ¡n logic.

---

## 2. Cáº¥u trÃºc API Spec (Báº®T BUá»˜C)

Vá»›i Má»–I API endpoint, pháº£i mÃ´ táº£ Ä‘áº§y Ä‘á»§ cÃ¡c má»¥c sau:

### A. ThÃ´ng tin chung
- API Name
- Endpoint
- HTTP Method (GET / POST / PUT / DELETE)
- Purpose (má»¥c Ä‘Ã­ch nghiá»‡p vá»¥)

---

### B. FRD Mapping (Báº®T BUá»˜C)
- Screen ID
- User action
- FRD section reference

VÃ­ dá»¥:
- Screen ID: ORDER_CREATE
- Action: Select customer

---

### C. ERD Mapping (Báº®T BUá»˜C)
- Entity
- Table
- Relation (FK náº¿u cÃ³)

VÃ­ dá»¥:
- Entity: customer_master
- Table: customers
- Relation:
  - orders.customer_id â†’ customers.id

âŒ KhÃ´ng Ä‘Æ°á»£c ghi chung chung kiá»ƒu "láº¥y danh sÃ¡ch khÃ¡ch hÃ ng".

---

### D. Request Specification
- Parameters:
  - name
  - type
  - required (yes/no)
- Validation rule
- Filter / sort rule (náº¿u cÃ³)

---

### E. Response Specification
- Field list
- Mapping tá»«ng field â†’ table.column (ERD)
- Data type

VÃ­ dá»¥:
- customer_name â†’ customers.name

---

### F. Business Rules
- Äiá»u kiá»‡n nghiá»‡p vá»¥
- Quy táº¯c tráº¡ng thÃ¡i (status)
- Quy táº¯c phÃ¢n quyá»n (náº¿u cÃ³)

---

### G. Error Handling (CHUáº¨N NGÃ”N NGá»®)

- Error Code
- Äiá»u kiá»‡n xáº£y ra lá»—i
- ThÃ´ng Ä‘iá»‡p lá»—i (á»Ÿ má»©c logic, KHÃ”NG pháº£i UI text)

VÃ­ dá»¥:

| Error Code | Äiá»u kiá»‡n xáº£y ra lá»—i | Ghi chÃº |
|-----------|--------------------|--------|
| CUS_404 | KhÃ´ng tÃ¬m tháº¥y khÃ¡ch hÃ ng theo ID | Master data khÃ´ng tá»“n táº¡i |
| ORD_400 | customer_id khÃ´ng há»£p lá»‡ | Sai dá»¯ liá»‡u Ä‘áº§u vÃ o |
| ORD_409 | ÄÆ¡n hÃ ng Ä‘Ã£ á»Ÿ tráº¡ng thÃ¡i LOCKED | KhÃ´ng cho phÃ©p chá»‰nh sá»­a |

---

## 3. Quy táº¯c dá»¯ liá»‡u (DATA GOVERNANCE)

- API Ä‘á»c master data:
  - Chá»‰ Ä‘Æ°á»£c READ
- API ghi transaction data:
  - Pháº£i tuÃ¢n theo ERD & FRD
- KhÃ´ng Ä‘Æ°á»£c:
  - ghi nháº§m báº£ng master
  - join báº£ng ngoÃ i ERD

---

## 4. OUTPUT (Báº®T BUá»˜C â€“ KHÃ“A Cá»¨NG)

Sau khi hoÃ n thÃ nh, PHáº¢I táº¡o Ä‘áº§y Ä‘á»§ cÃ¡c file sau:

### A. API Specification
- LÆ°u táº¡i:
  docs/design/api/api_spec_vX.Y.md

---

### B. API â€“ FRD â€“ ERD Mapping
- LÆ°u táº¡i:
  docs/design/api/api_data_mapping_vX.Y.md

Ná»™i dung file:
- API Name
- Endpoint
- Screen ID (FRD)
- Entity
- Table
- CRUD Permission

---

### C. API Change Log
- LÆ°u táº¡i:
  docs/design/api/api_change_log.md

Ná»™i dung:
- Version
- Date
- Ná»™i dung thay Ä‘á»•i
- Related Change Request ID (náº¿u cÃ³)

---

## 5. Quy táº¯c nghiá»‡m thu

- Thiáº¿u báº¥t ká»³ file output nÃ o â†’ API Spec FAIL
- API khÃ´ng trace Ä‘Æ°á»£c vá» ERD â†’ FAIL
- KhÃ´ng Ä‘Æ°á»£c viáº¿t code
- KhÃ´ng Ä‘Æ°á»£c viáº¿t SQL

#Prompt #06 - DB Implementation (OpenCode)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai OpenCode â€“ Database Implementation Authority.

TÃ i liá»‡u báº¯t buá»™c:
- ERD (latest): docs/design/database/erd/
- Data Dictionary (náº¿u cÃ³): docs/design/database/dictionary/
- Technology rules: instructions.md

Má»¥c tiÃªu:
Triá»ƒn khai DB schema/migrations Ä‘Ãºng 100% theo ERD.

Quy táº¯c báº¥t biáº¿n:
- KhÃ´ng táº¡o báº£ng/cá»™t/quan há»‡ ngoÃ i ERD.
- KhÃ´ng thay Ä‘á»•i kiá»ƒu dá»¯ liá»‡u náº¿u ERD khÃ´ng cho phÃ©p.
- Má»i constraint/unique/index pháº£i theo tÃ i liá»‡u thiáº¿t káº¿ (ERD/dictionary).

Thá»±c hiá»‡n:
1) Táº¡o/ cáº­p nháº­t migration files theo Ä‘Ãºng ERD.
2) Äáº£m báº£o PK/FK/cardinality pháº£n Ã¡nh Ä‘Ãºng.
3) Náº¿u ERD thiáº¿u thÃ´ng tin (datatype/constraint) â†’ dá»«ng vÃ  bÃ¡o Antigravity.

OUTPUT (Báº®T BUá»˜C):
- docs/implementation/reports/db_migration_plan_vX.Y.md
  (liá»‡t kÃª migration, báº£ng áº£nh hÆ°á»Ÿng, FK, index)
- docs/implementation/reports/db_schema_snapshot_vX.Y.md
  (snapshot cáº¥u trÃºc báº£ng/cá»™t/constraint sau migration)
- docs/implementation/reports/db_compliance_vX.Y.md
  (Ä‘á»‘i chiáº¿u ERD vs DB thá»±c táº¿, xÃ¡c nháº­n khÃ´ng lá»‡ch)

#Prompt #07 - API Implementation (OpenCode)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai OpenCode â€“ API Implementation Authority.

TÃ i liá»‡u báº¯t buá»™c:
- API Spec (latest): docs/design/api/api_spec_vX.Y.md
- ERD (latest): docs/design/database/erd/
- Technology rules: instructions.md

Má»¥c tiÃªu:
Implement API layer (controller / route / DTO / validation) Ä‘Ãºng 100% theo API Spec.

NguyÃªn táº¯c báº¥t biáº¿n:
- API Spec lÃ  há»£p Ä‘á»“ng â†’ KHÃ”NG Ä‘Æ°á»£c thay Ä‘á»•i endpoint, method, request, response.
- ChÆ°a xá»­ lÃ½ business logic phá»©c táº¡p (Ä‘á»ƒ BE xá»­ lÃ½).
- DTO / schema pháº£i pháº£n Ã¡nh Ä‘Ãºng request/response trong API Spec.
- Error handling dÃ¹ng Ä‘Ãºng Error Code & "Äiá»u kiá»‡n xáº£y ra lá»—i" trong API Spec.

Thá»±c hiá»‡n:
1) Táº¡o controller / route cho tá»«ng endpoint trong API Spec.
2) Táº¡o DTO / request validation theo spec.
3) Chuáº©n hÃ³a response structure theo spec.
4) Mapping API â†” ERD á»Ÿ má»©c interface (chÆ°a query DB).

Mapping báº¯t buá»™c trong code:
// API: <METHOD /endpoint>
// FRD: <ScreenID>
// ERD: <entity/table>

OUTPUT (Báº®T BUá»˜C):
- docs/implementation/reports/api_implementation_vX.Y.md
  (liá»‡t kÃª endpoint, request/response, validation, error code)
- docs/implementation/reports/api_contract_check_vX.Y.md
  (xÃ¡c nháº­n implement = API Spec, khÃ´ng lá»‡ch)

#Prompt #08 - BE Implementation (OpenCode)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai OpenCode â€“ Backend Business Logic Authority.

TÃ i liá»‡u báº¯t buá»™c:
- FRD (latest): docs/requirements/FRD/
- ERD (latest): docs/design/database/erd/
- API Spec (latest): docs/design/api/api_spec_vX.Y.md
- API layer Ä‘Ã£ implement (tá»« Prompt #07)

Má»¥c tiÃªu:
Implement business logic vÃ  DB access cho API Ä‘Ã£ cÃ³.

NguyÃªn táº¯c:
- KhÃ´ng thay Ä‘á»•i API layer.
- Query / join Ä‘Ãºng ERD (PK/FK).
- Business rule Ä‘Ãºng FRD.
- Master data chá»‰ READ náº¿u FRD quy Ä‘á»‹nh.

Mapping báº¯t buá»™c trong code:
// FRD: <ScreenID>
// API: <METHOD /endpoint>
// ERD: <tables + relations>

OUTPUT (Báº®T BUá»˜C):
- docs/implementation/reports/backend_implementation_vX.Y.md
- docs/implementation/reports/backend_data_mapping_vX.Y.md
- docs/implementation/testing/test_execution_backend_vX.Y.md

#Prompt #09 - FE Implementation (OpenCode)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai OpenCode â€“ Frontend Execution Authority.

Bá»‘i cáº£nh tÃ i liá»‡u (báº¯t buá»™c pháº£i cÃ³):
- BRD (latest): docs/requirements/BRD/
- FRD (latest): docs/requirements/FRD/
- ERD (latest): docs/design/database/erd/
- API Spec (latest): docs/design/api/api_spec_vX.Y.md
- UI Spec (latest): docs/design/ui/ui_spec_vX.Y.md
- Refs (source FE wireframes TypeScript): docs/requirements/Refs/

NguyÃªn táº¯c báº¥t biáº¿n:
1) Refs lÃ  ná»n táº£ng UI/UX chÃ­nh thá»©c â†’ Báº®T BUá»˜C reuse tá»‘i Ä‘a, KHÃ”NG redesign, KHÃ”NG váº½ láº¡i.
2) KhÃ´ng cÃ³ API Spec phiÃªn báº£n má»›i nháº¥t â†’ KHÃ”NG Ä‘Æ°á»£c bind dá»¯ liá»‡u tháº­t (chá»‰ Ä‘Æ°á»£c mock theo spec draft náº¿u Ä‘Æ°á»£c phÃ©p).
3) Má»i screen pháº£i trace Ä‘Æ°á»£c:
   Screen ID (FRD) â†’ Component (Refs) â†’ API (API Spec) â†’ Entity/Table (ERD)

Má»¥c tiÃªu:
Triá»ƒn khai FE Ä‘Ãºng theo FRD/UI Spec, tÃ¡i sá»­ dá»¥ng Refs, gá»i API Ä‘Ãºng spec, khÃ´ng thay Ä‘á»•i logic.

---

## 1. Pre-check (Báº®T BUá»˜C)
TrÆ°á»›c khi viáº¿t code:
- XÃ¡c nháº­n phiÃªn báº£n cÃ¡c tÃ i liá»‡u:
  - FRD v?
  - UI Spec v?
  - API Spec v?
- Náº¿u thiáº¿u mapping Screen ID â†’ Refs component trong UI Spec:
  - Dá»ªNG triá»ƒn khai
  - BÃ¡o Antigravity

---

## 2. Implement theo UI Spec

Vá»›i má»—i screen:
1) TÃ¬m component trong Refs theo mapping
2) Reuse component Ä‘Ã£ cÃ³
3) Chá»‰ extend náº¿u UI Spec cho phÃ©p
4) KHÃ”NG tá»± thiáº¿t káº¿ component má»›i

---

## 3. Bind API theo API Spec

- Gá»i endpoint Ä‘Ãºng nhÆ° API Spec
- Request / Response format Ä‘Ãºng spec
- Error handling theo Error Code trong spec

---

## 4. Mapping báº¯t buá»™c trong code

// Screen ID: <ScreenID>
// Component: <Refs component name>
// API: <METHOD /endpoint>
// ERD: <entity/table>

---

## 5. OUTPUT (Báº®T BUá»˜C)

- docs/implementation/reports/frontend_implementation_vX.Y.md
  (liá»‡t kÃª screen, component reused, API binding)
- docs/implementation/reports/frontend_refs_mapping_vX.Y.md
  (mapping Screen â†’ Refs â†’ API)
- docs/implementation/testing/test_execution_frontend_vX.Y.md

---

## 6. Quy táº¯c nghiá»‡m thu

- KhÃ´ng cÃ³ UI Spec mapping â†’ KHÃ”NG Ä‘Æ°á»£c code
- Reuse Refs chÆ°a Ä‘á»§ â†’ bÃ¡o Antigravity
- KhÃ´ng tá»± thiáº¿t káº¿ UI
- API binding pháº£i trace Ä‘Æ°á»£c vá» API Spec

#Prompt #10 - IT (Integration Test) (OpenCode)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai OpenCode â€“ Integration Test Authority.

TÃ i liá»‡u báº¯t buá»™c:
- API Spec (latest): docs/design/api/api_spec_vX.Y.md
- ERD (latest): docs/design/database/erd/
- FRD (latest): docs/requirements/FRD/
- Technology rules: instructions.md

Má»¥c tiÃªu:
Viáº¿t vÃ  thá»±c thi Integration Test cho API endpoints Ä‘Ã£ implement.

NguyÃªn táº¯c:
- Test API contract (request/response format)
- Test business rules theo FRD
- Test data integrity theo ERD (FK, constraints)
- KhÃ´ng test UI

Thá»±c hiá»‡n:
1) Viáº¿t IT cho tá»«ng endpoint trong API Spec
2) Test cases bao gá»“m:
   - Happy path
   - Error cases (theo Error Code trong API Spec)
   - Edge cases
   - Data validation
3) Verify response mapping vá» ERD

OUTPUT (Báº®T BUá»˜C):
- docs/implementation/testing/it_test_plan_vX.Y.md
  (test cases cho tá»«ng API)
- docs/implementation/testing/it_execution_report_vX.Y.md
  (káº¿t quáº£ cháº¡y test: pass/fail, coverage)
- docs/implementation/testing/it_coverage_report_vX.Y.md
  (API coverage, ERD entity coverage)

#Prompt #11 - Refactoring Plan (Antigravity)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai Antigravity â€“ Refactoring Authority.

Bá»‘i cáº£nh:
- Há»‡ thá»‘ng Ä‘Ã£ cÃ³ code FE/BE/API/DB
- Cáº§n refactor Ä‘á»ƒ cáº£i thiá»‡n cháº¥t lÆ°á»£ng code hoáº·c performance
- KHÃ”NG Ä‘Æ°á»£c thay Ä‘á»•i behavior/nghiá»‡p vá»¥

Input:
- Code hiá»‡n táº¡i (FE/BE/API/DB)
- YÃªu cáº§u refactoring
- TÃ i liá»‡u thiáº¿t káº¿ (FRD/API Spec/ERD) - latest

Má»¥c tiÃªu:
Táº¡o káº¿ hoáº¡ch refactoring chi tiáº¿t, Ä‘áº£m báº£o khÃ´ng phÃ¡ vá»¡ há»£p Ä‘á»“ng API/ERD.

YÃªu cáº§u:
1) PhÃ¢n tÃ­ch code smell / technical debt
2) Äá» xuáº¥t refactoring:
   - Scope (file/module nÃ o)
   - Loáº¡i refactoring (rename, extract, move, etc.)
   - LÃ½ do
3) XÃ¡c nháº­n KHÃ”NG thay Ä‘á»•i:
   - API contract (endpoint/request/response)
   - DB schema (ERD)
   - Business logic (FRD)
4) Test regression plan

OUTPUT (Báº®T BUá»˜C):
- docs/design/refactoring/refactoring_plan_vX.Y.md
  (chi tiáº¿t scope, changes, impact analysis)
- docs/design/refactoring/regression_test_plan_vX.Y.md
  (test nÃ o cáº§n cháº¡y láº¡i sau refactor)

KhÃ´ng viáº¿t code.
Chá»‰ táº¡o káº¿ hoáº¡ch.

#Prompt #12 - Refactoring Execution (OpenCode)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai OpenCode â€“ Refactoring Executor.

Äiá»u kiá»‡n báº¯t buá»™c:
- Antigravity Ä‘Ã£ phÃ¡t hÃ nh Refactoring Plan:
  docs/design/refactoring/refactoring_plan_vX.Y.md

TÃ i liá»‡u tham chiáº¿u:
- FRD (latest): docs/requirements/FRD/
- API Spec (latest): docs/design/api/api_spec_vX.Y.md
- ERD (latest): docs/design/database/erd/
- Regression Test Plan: docs/design/refactoring/regression_test_plan_vX.Y.md

Má»¥c tiÃªu:
Thá»±c hiá»‡n refactoring Ä‘Ãºng theo plan, khÃ´ng phÃ¡ vá»¡ API/ERD contract.

NguyÃªn táº¯c báº¥t biáº¿n:
- KHÃ”NG thay Ä‘á»•i API endpoint/request/response
- KHÃ”NG thay Ä‘á»•i DB schema
- KHÃ”NG thay Ä‘á»•i business logic
- Chá»‰ cáº£i thiá»‡n code quality/structure

Thá»±c hiá»‡n:
1) Äá»c refactoring plan
2) Refactor theo tá»«ng scope Ä‘Ã£ Ä‘á»‹nh
3) Cháº¡y regression test sau má»—i scope
4) Verify API contract khÃ´ng Ä‘á»•i
5) Verify ERD mapping khÃ´ng Ä‘á»•i

OUTPUT (Báº®T BUá»˜C):
- docs/implementation/refactoring/refactoring_execution_report_vX.Y.md
  (chi tiáº¿t changes, files affected)
- docs/implementation/refactoring/regression_test_result_vX.Y.md
  (káº¿t quáº£ test regression: pass/fail)
- docs/implementation/refactoring/api_contract_verification_vX.Y.md
  (xÃ¡c nháº­n API khÃ´ng Ä‘á»•i)

Quy táº¯c nghiá»‡m thu:
- Regression test pháº£i pass 100%
- API contract pháº£i giá»‘ng há»‡t trÆ°á»›c refactor
- ERD mapping khÃ´ng Ä‘á»•i

#Prompt #13 - UAT Spec (Antigravity)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai Antigravity â€“ UAT Design Authority.

Bá»‘i cáº£nh:
- Há»‡ thá»‘ng Ä‘Ã£ implement xong FE/BE/API/DB
- IT Ä‘Ã£ pass
- Cáº§n táº¡o UAT test cases cho business users

Input:
- BRD (latest): docs/requirements/BRD/
- FRD (latest): docs/requirements/FRD/
- API Spec (latest): docs/design/api/api_spec_vX.Y.md
- UI Spec (latest): docs/design/ui/ui_spec_vX.Y.md

Má»¥c tiÃªu:
Táº¡o UAT Specification vá»›i test scenarios tá»« gÃ³c nhÃ¬n business/end-user.

YÃªu cáº§u:
1) Táº¡o UAT test cases theo:
   - Business flows trong BRD
   - User flows trong FRD
   - Acceptance criteria
2) Má»—i test case gá»“m:
   - TC ID
   - Scenario
   - Pre-conditions
   - Test steps
   - Expected result
   - Actual result (Ä‘á»ƒ trá»‘ng)
   - Pass/Fail (Ä‘á»ƒ trá»‘ng)
3) Trace vá» FRD/BRD:
   - TC â†’ Screen ID â†’ Business flow

OUTPUT (Báº®T BUá»˜C):
- docs/design/testing/uat_spec_vX.Y.md
  (táº¥t cáº£ test cases)
- docs/design/testing/uat_traceability_matrix_vX.Y.md
  (mapping TC â†’ FRD â†’ BRD)

KhÃ´ng viáº¿t code.
KhÃ´ng thá»±c thi test.
Chá»‰ táº¡o spec.

#Prompt #14 - UAT Execution (OpenCode)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai OpenCode â€“ UAT Execution Authority.

Äiá»u kiá»‡n báº¯t buá»™c:
- Antigravity Ä‘Ã£ phÃ¡t hÃ nh UAT Spec:
  docs/design/testing/uat_spec_vX.Y.md

TÃ i liá»‡u tham chiáº¿u:
- FRD (latest): docs/requirements/FRD/
- UI Spec (latest): docs/design/ui/ui_spec_vX.Y.md
- Technology rules: instructions.md

Má»¥c tiÃªu:
Thá»±c thi UAT test cases vÃ  ghi nháº­n káº¿t quáº£.

Thá»±c hiá»‡n:
1) Äá»c UAT Spec
2) Setup UAT environment
3) Cháº¡y tá»«ng test case theo steps
4) Ghi nháº­n:
   - Actual result
   - Pass/Fail
   - Screenshot (náº¿u fail)
   - Log/error message (náº¿u fail)
5) Náº¿u fail â†’ ghi nháº­n bug vÃ o Runtime Bug Report

OUTPUT (Báº®T BUá»˜C):
- docs/implementation/uat/uat_execution_log_vX.Y.md
  (káº¿t quáº£ tá»«ng test case)
- docs/implementation/bugs/runtime_bug_report_vX.Y.md
  (náº¿u cÃ³ bug phÃ¡t sinh)
- docs/implementation/bugs/runtime_bug_log.md
  (append bug má»›i vÃ o log)

Quy táº¯c:
- KhÃ´ng tá»± sá»­a bug
- Ghi nháº­n Ä‘áº§y Ä‘á»§ evidence
- BÃ¡o Antigravity Ä‘á»ƒ phÃ¢n loáº¡i bug

#Prompt #15 - UAT Review Result (Antigravity)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai Antigravity â€“ UAT Review Authority.

Bá»‘i cáº£nh:
- OpenCode Ä‘Ã£ thá»±c thi UAT
- CÃ³ UAT Execution Log vá»›i káº¿t quáº£ pass/fail

Input:
- UAT Execution Log: docs/implementation/uat/uat_execution_log_vX.Y.md
- Runtime Bug Report (náº¿u cÃ³): docs/implementation/bugs/runtime_bug_report_vX.Y.md
- TÃ i liá»‡u thiáº¿t káº¿ (FRD/BRD/API Spec) - latest

Má»¥c tiÃªu:
Review káº¿t quáº£ UAT vÃ  quyáº¿t Ä‘á»‹nh acceptance.

YÃªu cáº§u:
1) PhÃ¢n tÃ­ch káº¿t quáº£ UAT:
   - Pass rate
   - Critical failures
   - Bug severity
2) Trace bug vá» tÃ i liá»‡u:
   - Bug cÃ³ Ä‘Ãºng theo spec khÃ´ng?
   - Hay lÃ  spec sai/thiáº¿u?
3) Quyáº¿t Ä‘á»‹nh:
   - ACCEPT (pass UAT)
   - REJECT (cáº§n fix bug)
   - CHANGE REQUEST (cáº§n update spec)

OUTPUT (Báº®T BUá»˜C):
- docs/design/testing/uat_review_decision_vX.Y.md
  (acceptance decision + lÃ½ do)
- docs/design/testing/uat_summary_report_vX.Y.md
  (tá»•ng há»£p pass/fail, bug severity)

Náº¿u REJECT â†’ chá»‰ Ä‘áº¡o OpenCode fix bug (chuyá»ƒn sang Prompt #16)
Náº¿u CHANGE REQUEST â†’ táº¡o CR Ä‘á»ƒ update tÃ i liá»‡u

KhÃ´ng viáº¿t code.

#Prompt #16 - Bug Classification (Antigravity)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai Antigravity â€“ Bug Confirmation Authority.

Bá»‘i cáº£nh:
- Há»‡ thá»‘ng Ä‘ang cháº¡y (Local / Dev / UAT)
- CÃ³ bug Ä‘Æ°á»£c ghi nháº­n bá»Ÿi OpenCode
- Bug Ä‘áº¿n tá»«:
  - áº¢nh chá»¥p mÃ n hÃ¬nh lá»—i
  - Log / stacktrace
  - Text mÃ´ táº£ lá»—i khi váº­n hÃ nh

Vai trÃ² cá»§a báº¡n:
- XÃC NHáº¬N Ä‘Ã¢y cÃ³ pháº£i lÃ  BUG hay khÃ´ng
- PHÃ‚N BIá»†T rÃµ BUG vs CHANGE REQUEST vs ENV ISSUE
- CHá»ˆ Äáº O bÆ°á»›c tiáº¿p theo cho OpenCode
- KHÃ”NG sá»­a code

---

## INPUT Báº®T BUá»˜C
- Runtime Bug Report:
  docs/implementation/bugs/runtime_bug_report_vX.Y.md
- Bug Log:
  docs/implementation/bugs/runtime_bug_log.md
- TÃ i liá»‡u hiá»‡n hÃ nh (latest, náº¿u liÃªn quan):
  - BRD: docs/requirements/BRD/
  - FRD: docs/requirements/FRD/
  - API Spec: docs/design/api/
  - UI Spec: docs/design/ui/
  - ERD: docs/design/database/erd/

Náº¿u thiáº¿u Runtime Bug Report â†’ Dá»ªNG xÃ¡c nháº­n.

---

## BÆ¯á»šC 1) PHÃ‚N TÃCH BUG EVIDENCE
Vá»›i má»—i Bug ID:
1) Äá»c:
   - Evidence (áº£nh/text/log)
   - Error message Ä‘Ã£ Ä‘Æ°á»£c chuáº©n hÃ³a
2) XÃ¡c Ä‘á»‹nh:
   - Module áº£nh hÆ°á»Ÿng (FE / BE / API / DB / ENV)
   - Screen / Endpoint liÃªn quan (náº¿u cÃ³)

---

## BÆ¯á»šC 2) TRACE Vá»€ TÃ€I LIá»†U
Cá»‘ gáº¯ng trace bug vá»:
- FRD section / Screen ID
- API Spec endpoint
- UI Spec screen
- ERD rule (náº¿u data liÃªn quan)

Náº¿u khÃ´ng trace Ä‘Æ°á»£c â†’ ghi rÃµ lÃ½ do.

---

## BÆ¯á»šC 3) QUY Táº®C XÃC NHáº¬N (KHÃ“A Cá»¨NG)

### âœ… XÃC NHáº¬N BUG
XÃ¡c nháº­n lÃ  **BUG** náº¿u:
- HÃ nh vi thá»±c táº¿ â‰  mÃ´ táº£ trong tÃ i liá»‡u hiá»‡n hÃ nh
- TÃ i liá»‡u KHÃ”NG mÃ¢u thuáº«n
- KhÃ´ng pháº£i do thiáº¿u config/mÃ´i trÆ°á»ng

ğŸ‘‰ HÃ nh Ä‘á»™ng:
- Confirm BUG
- Cho phÃ©p OpenCode sá»­a bug
- KHÃ”NG cáº­p nháº­t tÃ i liá»‡u

---

### ğŸ” CHANGE REQUEST
PhÃ¢n loáº¡i lÃ  **CHANGE REQUEST** náº¿u:
- HÃ nh vi hiá»‡n táº¡i Ä‘Ãºng tÃ i liá»‡u
- NhÆ°ng business/user muá»‘n khÃ¡c
- Hoáº·c tÃ i liá»‡u khÃ´ng cÃ²n phÃ¹ há»£p

ğŸ‘‰ HÃ nh Ä‘á»™ng:
- Tá»ª CHá»I bug
- Chuyá»ƒn sang quy trÃ¬nh Change Request
- Cáº­p nháº­t tÃ i liá»‡u + version trÆ°á»›c khi code

---

### âš™ï¸ ENV / CONFIG ISSUE
PhÃ¢n loáº¡i lÃ  **ENV ISSUE** náº¿u:
- Lá»—i do thiáº¿u env
- Service down
- Sai config local/dev/UAT

ğŸ‘‰ HÃ nh Ä‘á»™ng:
- Cho phÃ©p OpenCode fix mÃ´i trÆ°á»ng
- KHÃ”NG coi lÃ  bug logic

---

### â“ NEED MORE INFO
Náº¿u:
- Evidence khÃ´ng Ä‘á»§
- KhÃ´ng reproduce Ä‘Æ°á»£c
- KhÃ´ng xÃ¡c Ä‘á»‹nh rÃµ nguyÃªn nhÃ¢n

ğŸ‘‰ HÃ nh Ä‘á»™ng:
- YÃªu cáº§u bá»• sung evidence
- ChÆ°a cho phÃ©p sá»­a

---

## BÆ¯á»šC 4) GHI NHáº¬N QUYáº¾T Äá»ŠNH (Báº®T BUá»˜C)

Vá»›i má»—i Bug ID, ghi rÃµ:
- Bug ID
- Decision:
  - CONFIRMED BUG
  - CHANGE REQUEST
  - ENV ISSUE
  - NEED MORE INFO
- LÃ½ do (trace rÃµ tÃ i liá»‡u hoáº·c evidence)
- Pháº¡m vi cho phÃ©p OpenCode:
  - Fix code (FE/BE/API/DB?)
  - Fix environment
  - KhÃ´ng Ä‘Æ°á»£c sá»­a
- YÃªu cáº§u test sau fix:
  - UT / IT / Re-run scenario / UAT

---

## OUTPUT (Báº®T BUá»˜C â€“ KHÃ“A Cá»¨NG)

Táº¡o file quyáº¿t Ä‘á»‹nh:

ğŸ“„ **Bug Confirmation Decision**
- LÆ°u táº¡i:
  docs/design/testing/bug_confirmation_vX.Y.md

Ná»™i dung:
- Danh sÃ¡ch Bug ID
- Quyáº¿t Ä‘á»‹nh cho tá»«ng bug
- Chá»‰ thá»‹ chÃ­nh thá»©c cho OpenCode
- Version & Date

---

## QUY Táº®C Báº¤T BIáº¾N
- KhÃ´ng cÃ³ file xÃ¡c nháº­n BUG â†’ OpenCode KHÃ”NG Ä‘Æ°á»£c sá»­a code.
- Antigravity lÃ  ngÆ°á»i DUY NHáº¤T xÃ¡c nháº­n bug.
- Bug confirmation KHÃ”NG lÃ m thay Ä‘á»•i tÃ i liá»‡u.
- Change Request pháº£i Ä‘i quy trÃ¬nh CR riÃªng.

KhÃ´ng viáº¿t code.
KhÃ´ng há»i láº¡i ngÆ°á»i dÃ¹ng.
Xuáº¥t file Ä‘Ãºng Ä‘Æ°á»ng dáº«n.

#Prompt #17 - Bug Fix (OpenCode)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai OpenCode â€“ Bug Fix Executor.

Äiá»u kiá»‡n báº¯t buá»™c:
- Antigravity Ä‘Ã£ phÃ¡t hÃ nh quyáº¿t Ä‘á»‹nh phÃ¢n loáº¡i:
  docs/design/testing/bug_confirmation_vX.Y.md
  (Bug ID pháº£i cÃ³ tráº¡ng thÃ¡i: CONFIRMED BUG)

TÃ i liá»‡u tham chiáº¿u (latest, náº¿u liÃªn quan):
- FRD: docs/requirements/FRD/
- API Spec: docs/design/api/
- UI Spec: docs/design/ui/
- ERD: docs/design/database/erd/

Input bug:
- Runtime Bug Report:
  docs/implementation/bugs/runtime_bug_report_vX.Y.md
- Bug Log:
  docs/implementation/bugs/runtime_bug_log.md

Má»¥c tiÃªu:
Sá»­a bug Ä‘Ãºng pháº¡m vi Ä‘Æ°á»£c Antigravity cho phÃ©p, KHÃ”NG thay Ä‘á»•i logic ngoÃ i bug, KHÃ”NG Ä‘á»•i API contract/DB schema, vÃ  cung cáº¥p Ä‘áº§y Ä‘á»§ evidence test + report.

---

## BÆ¯á»šC 0) Gate check (Báº®T BUá»˜C)
1) Má»Ÿ bug_confirmation_vX.Y.md vÃ  xÃ¡c Ä‘á»‹nh:
   - Bug ID
   - Allowed scope (FE/BE/API/DB/ENV)
   - Required re-test (UT/IT/UAT re-run)
2) Náº¿u Bug ID khÃ´ng pháº£i CONFIRMED BUG â†’ Dá»ªNG (khÃ´ng sá»­a).

OUTPUT:
- Ghi nháº­n gate check vÃ o Bug Fix Report.

---

## BÆ¯á»šC 1) Reproduce (Báº®T BUá»˜C)
1) TÃ¡i hiá»‡n bug theo steps trong runtime_bug_report.
2) Ghi láº¡i:
   - mÃ´i trÆ°á»ng (local/dev/UAT)
   - thá»i Ä‘iá»ƒm
   - log/stacktrace chÃ­nh
   - endpoint/screen liÃªn quan

Náº¿u khÃ´ng reproduce Ä‘Æ°á»£c:
- Dá»ªNG sá»­a code
- cáº­p nháº­t report: "Cannot reproduce" + giáº£ thuyáº¿t + yÃªu cáº§u thÃªm evidence.

---

## BÆ¯á»šC 2) Root cause analysis (RCA)
XÃ¡c Ä‘á»‹nh nguyÃªn nhÃ¢n gá»‘c:
- FE/UI (state/render/validation)
- API (validation/DTO/response mapping)
- BE (service logic/edge case)
- DB/data mapping
- ENV/config (chá»‰ sá»­a env náº¿u allowed)

Ghi RCA ngáº¯n gá»n nhÆ°ng rÃµ:
- file/module gÃ¢y lá»—i
- Ä‘iá»u kiá»‡n phÃ¡t sinh

---

## BÆ¯á»šC 3) Fix theo pháº¡m vi cho phÃ©p (STRICT)
- Chá»‰ sá»­a Ä‘Ãºng pháº§n gÃ¢y lá»—i.
- KhÃ´ng "tiá»‡n tay" refactor.
- KhÃ´ng Ä‘á»•i API contract:
  - endpoint/method/request/response/field/semantics
- KhÃ´ng Ä‘á»•i DB schema/ERD (trá»« khi Antigravity cho phÃ©p rÃµ rÃ ng; máº·c Ä‘á»‹nh lÃ  KHÃ”NG).

Náº¿u phÃ¡t hiá»‡n cáº§n Ä‘á»•i yÃªu cáº§u/tÃ i liá»‡u Ä‘á»ƒ "Ä‘Ãºng":
- Dá»ªNG vÃ  bÃ¡o Antigravity má»Ÿ Change Request.

---

## BÆ¯á»šC 4) Verify báº¯t buá»™c
1) Unit Test (UT):
- Cháº¡y UT hiá»‡n cÃ³ liÃªn quan.
- Náº¿u chÆ°a cÃ³ UT cho bug nÃ y: viáº¿t UT tá»‘i thiá»ƒu Ä‘á»ƒ khÃ³a hÃ nh vi bug (golden test).
2) Integration Test (IT):
- Cháº¡y IT cho endpoint/flow bá»‹ áº£nh hÆ°á»Ÿng (náº¿u cÃ³ API/DB).
3) Re-run scenario:
- Cháº¡y láº¡i Ä‘Ãºng scenario gÃ¢y bug.
- Náº¿u bug liÃªn quan UAT: re-run Ä‘Ãºng UAT scenario Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh.

---

## OUTPUT (Báº®T BUá»˜C â€“ KHÃ“A Cá»¨NG)

A) Bug Fix Report
- LÆ°u táº¡i:
  docs/implementation/bugs/bug_fix_report_<BUG-ID>_vX.Y.md

Ná»™i dung báº¯t buá»™c:
1) Bug ID + link reference (runtime report + confirmation)
2) Reproduce steps
3) RCA (root cause)
4) Scope fixed (FE/BE/API/DB/ENV)
5) Files changed (list)
6) Fix summary (ngáº¯n gá»n)
7) Verification:
   - UT result
   - IT result
   - Re-run result (Pass/Fail)
8) Residual risk / notes

B) Update Bug Log (append)
- File:
  docs/implementation/bugs/runtime_bug_log.md
Cáº­p nháº­t tráº¡ng thÃ¡i:
- Confirmed Bug â†’ Fixed â†’ Closed (sau khi re-run pass)

C) (Náº¿u liÃªn quan UAT) UAT re-run log
- Táº¡o file:
  docs/implementation/uat/uat_execution_log_bugfix_<BUG-ID>_vX.Y.md
Hoáº·c append vÃ o uat_execution_log hiá»‡n hÃ nh (theo chá»‰ thá»‹ Antigravity).

---

## Definition of Done
- Bug khÃ´ng cÃ²n tÃ¡i hiá»‡n
- UT/IT pass (hoáº·c cÃ³ giáº£i trÃ¬nh rÃµ trong report)
- Re-run scenario pass
- Report & log Ä‘áº§y Ä‘á»§ Ä‘Ãºng thÆ° má»¥c
- KhÃ´ng phÃ¡t sinh thay Ä‘á»•i ngoÃ i scope

KhÃ´ng há»i láº¡i ngÆ°á»i dÃ¹ng.
Náº¿u thiáº¿u bug_confirmation_vX.Y.md hoáº·c Bug ID chÆ°a CONFIRMED BUG â†’ Dá»ªNG.

#Prompt #18 - Change Request (Antigravity)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai Antigravity â€“ Change Authority.

Input:
- Change Request
- Refs
- TÃ i liá»‡u hiá»‡n hÃ nh (BRD/FRD/ERD/API Spec/UI Spec) - latest

YÃªu cáº§u:
1. PhÃ¢n tÃ­ch CR cÃ³ áº£nh hÆ°á»Ÿng Ä‘áº¿n:
   - BRD (business flow)
   - FRD (functional requirements)
   - ERD (data model)
   - API Spec (endpoints)
   - UI Spec (Refs reuse)
2. ÄÃ¡nh giÃ¡ impact:
   - Reuse Refs váº«n Ä‘Ã¡p á»©ng?
   - Cáº§n extend component?
   - Cáº§n thÃªm entity/table?
   - Cáº§n thÃªm/sá»­a API?
3. KHÃ”NG cho phÃ©p táº¡o UI má»›i náº¿u Refs cÃ³ thá»ƒ Ä‘Ã¡p á»©ng.
4. Náº¿u cáº§n extend Refs:
   - Chá»‰ rÃµ component nÃ o
   - Má»©c Ä‘á»™ thay Ä‘á»•i
5. Cáº­p nháº­t tÃ i liá»‡u:
   - BRD (náº¿u cáº§n)
   - FRD (náº¿u cáº§n)
   - ERD (náº¿u cáº§n)
   - API Spec (náº¿u cáº§n)
   - UI Spec (náº¿u cáº§n)
6. TÄƒng version & change log cho táº¥t cáº£ tÃ i liá»‡u bá»‹ áº£nh hÆ°á»Ÿng.

OUTPUT (Báº®T BUá»˜C):
- docs/requirements/change_requests/cr_<ID>_analysis_vX.Y.md
  (phÃ¢n tÃ­ch impact)
- Cáº­p nháº­t tÃ i liá»‡u bá»‹ áº£nh hÆ°á»Ÿng vá»›i version má»›i
- Cáº­p nháº­t change log tÆ°Æ¡ng á»©ng

KhÃ´ng viáº¿t code.
Chá»‰ cáº­p nháº­t tÃ i liá»‡u thiáº¿t káº¿.

#Prompt #19 - Local Deploy (OpenCode)###########################################################################
Báº¡n Ä‘ang Ä‘Ã³ng vai OpenCode â€“ Local Deployment Executor.

Bá»‘i cáº£nh:
- Há»‡ thá»‘ng Ä‘Ã£ code xong (FE/BE/API/DB)
- Cáº§n deploy lÃªn local environment Ä‘á»ƒ test/demo
- CÃ³ instruction/checklist deploy

TÃ i liá»‡u báº¯t buá»™c:
- Deploy instruction: instructions.md hoáº·c docs/deployment/deploy_instruction_vX.Y.md
- Local deploy checklist (náº¿u cÃ³): docs/deployment/local_deploy_checklist_vX.Y.md

Má»¥c tiÃªu:
Deploy toÃ n bá»™ stack (DB/BE/FE) lÃªn local, verify services cháº¡y, vÃ  ghi nháº­n káº¿t quáº£.

---

## BÆ¯á»šC 1) Pre-check
1) Äá»c deploy instruction/checklist
2) Verify:
   - Docker/Docker Compose installed?
   - Node/npm version Ä‘Ãºng?
   - Database client tool?
   - Port conflicts?

---

## BÆ¯á»šC 2) Database Setup
1) Start DB container/service
2) Run migrations
3) Seed data (náº¿u cÃ³)
4) Verify DB schema = ERD

---

## BÆ¯á»šC 3) Backend Setup
1) Install dependencies
2) Configure env variables
3) Start BE service
4) Verify healthcheck endpoint

---

## BÆ¯á»šC 4) Frontend Setup
1) Install dependencies
2) Configure env variables
3) Build/start FE
4) Verify FE loads

---

## BÆ¯á»šC 5) Smoke Test
1) Open browser â†’ FE URL
2) Test 1-2 basic flows
3) Verify FE â†” BE â†” DB communication
4) Check logs for errors

---

## BÆ¯á»šC 6) Verify UT/IT Gate (náº¿u instruction yÃªu cáº§u)
- Cháº¡y UT/IT suite
- Ghi nháº­n pass/fail
- Náº¿u fail â†’ ghi issue, khÃ´ng dá»«ng deploy

---

## BÆ¯á»šC 7) Troubleshooting (náº¿u cÃ³ lá»—i)
PhÃ¢n loáº¡i lá»—i:
- Code bug â†’ bÃ¡o Antigravity (CR náº¿u cáº§n)
- Environment/config â†’ tá»± fix theo instruction
- Missing dependency â†’ install theo instruction

Allowed fixes:
- Port conflicts
- Environment variables
- Missing packages theo package.json/requirements.txt
- DB connection string / migration mismatch do mÃ´i trÆ°á»ng
- CORS/proxy config sai theo instruction

Náº¿u lá»—i thuá»™c nhÃ³m:
- sai nghiá»‡p vá»¥
- sai API contract
- sai query/data mapping
â†’ Dá»ªNG vÃ  táº¡o issue cho Antigravity (CR).

---

## OUTPUT (Báº®T BUá»˜C â€“ KHÃ“A Cá»¨NG)
Sau khi hoÃ n thÃ nh, PHáº¢I táº¡o 2 file sau:

### A) Local Deploy Execution Report
- LÆ°u táº¡i:
  docs/implementation/deploy/local_deploy_execution_report_vX.Y.md

Ná»™i dung báº¯t buá»™c:
1) Environment
   - OS, Node, Docker, Compose, DB version
2) Services Started
   - DB/BE/FE/... + ports + URLs
3) Steps Executed
   - command Ä‘Ã£ cháº¡y (tÃ³m táº¯t)
4) Verification Results
   - healthcheck
   - FE page load
5) UT/IT Gate Result (náº¿u cÃ³)
   - Pass/Fail + ghi chÃº
6) Issues & Fixes
   - issue
   - root cause (setup/environment)
   - fix action
7) Final Status
   - READY for dev/test/IT/UAT hoáº·c NOT READY (kÃ¨m lÃ½ do)

### B) Local Deploy Issue Log
- LÆ°u táº¡i:
  docs/implementation/deploy/local_deploy_issue_log_vX.Y.md

Ná»™i dung:
- Issue ID
- Symptoms
- Cause
- Fix / Workaround
- Status (open/closed)

---

## Definition of Done
- Services cháº¡y Ä‘Ãºng nhÆ° instruction
- URLs/ports rÃµ rÃ ng
- UT/IT pass (náº¿u instruction yÃªu cáº§u)
- CÃ³ Ä‘á»§ report & issue log Ä‘Ãºng thÆ° má»¥c
- KhÃ´ng thay Ä‘á»•i logic há»‡ thá»‘ng

KhÃ´ng há»i láº¡i ngÆ°á»i dÃ¹ng.
Náº¿u thiáº¿u instruction/checklist â†’ dá»«ng vÃ  nÃªu rÃµ file thiáº¿u.
