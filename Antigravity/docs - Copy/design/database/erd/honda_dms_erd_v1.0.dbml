// Honda Dealer Management System - ERD v1.0
// Database: PostgreSQL (Production) / SQLite (Demo)
// Date: 2026-01-28
// Author: Antigravity - Data Design Authority

//=============================================================================
// ENUMS - Định nghĩa các giá trị enum
//=============================================================================

Enum user_role {
  ADMIN
  MANAGER
  SALES
  SERVICE
  PARTS
  ACCOUNTING
  INSURANCE
}

Enum lead_source {
  FACEBOOK
  WEBSITE
  WALK_IN
  HOTLINE
  REFERRAL
  OTHER
}

Enum lead_status {
  NEW
  CONTACTED
  QUALIFIED
  PROPOSAL
  NEGOTIATION
  WON
  DEAD
}

Enum customer_type {
  INDIVIDUAL
  COMPANY
}

Enum loyalty_tier {
  BRONZE
  SILVER
  GOLD
  PLATINUM
  DIAMOND
}

Enum quotation_status {
  DRAFT
  SENT
  APPROVED
  CONTRACT
  LOST
  EXPIRED
}

Enum test_drive_status {
  SCHEDULED
  COMPLETED
  CANCELLED
  NO_SHOW
}

Enum vin_status {
  AVAILABLE
  ALLOCATED
  SOLD
}

Enum deposit_status {
  PAID
  REFUNDED
  CANCELLED
}

Enum service_appointment_status {
  SCHEDULED
  CONFIRMED
  ARRIVED
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

Enum repair_order_status {
  PENDING
  IN_PROGRESS
  QC
  READY
  DELIVERED
}

Enum stock_movement_type {
  IN
  OUT
  TRANSFER
  ADJUSTMENT
}

Enum purchase_order_status {
  DRAFT
  SENT
  CONFIRMED
  RECEIVED
  CLOSED
}

Enum insurance_contract_status {
  ACTIVE
  EXPIRED
  CANCELLED
}

Enum insurance_claim_status {
  SUBMITTED
  REVIEWING
  APPROVED
  PAID
  REJECTED
}

Enum payment_method {
  CASH
  CARD
  TRANSFER
}

Enum transaction_type {
  DEBIT
  CREDIT
}

Enum activity_type {
  CALL
  EMAIL
  MEETING
  NOTE
  STAGE_CHANGE
}

Enum reminder_type {
  MAINTENANCE
  INSPECTION
  INSURANCE
  BIRTHDAY
}

Enum complaint_status {
  NEW
  IN_PROGRESS
  RESOLVED
  CLOSED
}

Enum campaign_type {
  SMS
  EMAIL
  SOCIAL
  EVENT
  ZALO
  FACEBOOK
}

Enum campaign_status {
  DRAFT
  ACTIVE
  PAUSED
  COMPLETED
}

//=============================================================================
// MODULE 8: ADMIN - User Management & System
//=============================================================================

Table users {
  id varchar [pk]
  email varchar [unique, not null]
  password_hash varchar [not null]
  name varchar [not null]
  role user_role [not null]
  department varchar
  phone varchar
  status varchar [not null, default: 'ACTIVE'] // ACTIVE, INACTIVE
  last_login timestamp
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'MASTER - Người dùng hệ thống. Read-only sau khi tạo, chỉ update status/password'
}

Table activity_logs {
  id varchar [pk]
  user_id varchar [ref: > users.id]
  action varchar [not null] // CREATE, UPDATE, DELETE, LOGIN
  entity varchar [not null] // Lead, Customer, RO, etc.
  entity_id varchar
  details text
  ip_address varchar
  created_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Audit log, append-only, không được xóa'
}

Table system_metrics {
  id varchar [pk]
  metric_type varchar [not null] // CPU, MEMORY, API_RESPONSE, ERROR
  value decimal [not null]
  unit varchar
  timestamp timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - System monitoring data'
}

//=============================================================================
// MODULE 2: CRM - Customer Relationship Management
//=============================================================================

Table leads {
  id varchar [pk]
  name varchar [not null]
  phone varchar [not null]
  email varchar
  address text
  model_interest varchar
  model_version varchar
  budget decimal
  source lead_source [not null]
  status lead_status [not null, default: 'NEW']
  score int [not null, default: 10]
  notes text
  customer_type customer_type
  customer_id varchar [ref: > customers.id] // NULL until converted
  assigned_to_id varchar [ref: > users.id]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Indexes {
    (phone) [name: 'idx_leads_phone']
    (status) [name: 'idx_leads_status']
    (assigned_to_id) [name: 'idx_leads_assigned']
  }
  
  Note: 'TRANSACTION - Khách hàng tiềm năng. Convert thành Customer khi WON'
}

Table customers {
  id varchar [pk]
  name varchar [not null]
  type customer_type [not null]
  phone varchar [unique, not null]
  mobile varchar
  email varchar
  street varchar
  ward varchar
  district varchar
  city varchar
  vat varchar // VAT number for companies
  tier loyalty_tier [not null, default: 'BRONZE']
  points int [not null, default: 0]
  total_points int [not null, default: 0]
  tags text // JSON array
  notes text
  member_since timestamp [not null, default: `now()`]
  last_transaction_date timestamp
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Indexes {
    (phone) [unique, name: 'idx_customers_phone']
    (tier) [name: 'idx_customers_tier']
  }
  
  Note: 'MASTER - Khách hàng chính thức. Phone UNIQUE constraint'
}

Table interactions {
  id varchar [pk]
  lead_id varchar [ref: > leads.id]
  customer_id varchar [ref: > customers.id]
  user_id varchar [ref: > users.id, not null]
  type activity_type [not null]
  outcome varchar
  notes text
  metadata text // JSON
  created_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Lịch sử tương tác với Lead/Customer'
}

Table scoring_rules {
  id varchar [pk]
  name varchar [not null]
  category varchar [not null] // DEMOGRAPHIC, BEHAVIOR, ENGAGEMENT, INTENT
  condition text [not null] // JSON conditions
  points int [not null]
  is_active boolean [not null, default: true]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'MASTER - Quy tắc chấm điểm lead'
}

Table reminders {
  id varchar [pk]
  customer_id varchar [ref: > customers.id, not null]
  type reminder_type [not null]
  scheduled_date date [not null]
  message text
  channel varchar // SMS, EMAIL, CALL
  status varchar [not null, default: 'PENDING'] // PENDING, SENT, FAILED
  sent_at timestamp
  created_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Nhắc nhở bảo dưỡng/đăng kiểm'
}

Table loyalty_transactions {
  id varchar [pk]
  customer_id varchar [ref: > customers.id, not null]
  points int [not null]
  type varchar [not null] // EARN, REDEEM
  reason varchar [not null]
  reference_id varchar // Link to order/service
  created_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Lịch sử cộng/trừ điểm loyalty'
}

Table complaints {
  id varchar [pk]
  customer_id varchar [ref: > customers.id, not null]
  category varchar [not null] // PRODUCT, SERVICE, DELIVERY, PRICING, OTHER
  priority varchar [not null] // LOW, MEDIUM, HIGH, CRITICAL
  status complaint_status [not null, default: 'NEW']
  description text [not null]
  resolution text
  assigned_to_id varchar [ref: > users.id]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  resolved_at timestamp
  
  Note: 'TRANSACTION - Khiếu nại khách hàng'
}

Table marketing_campaigns {
  id varchar [pk]
  name varchar [not null]
  type campaign_type [not null]
  status campaign_status [not null, default: 'DRAFT']
  target_segment text // JSON criteria
  budget decimal
  start_date date
  end_date date
  sent_count int [default: 0]
  opened_count int [default: 0]
  clicked_count int [default: 0]
  converted_count int [default: 0]
  created_by_id varchar [ref: > users.id]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Chiến dịch marketing'
}

//=============================================================================
// MODULE 3: SALES - Quotation, Test Drive, VIN, Deposit, Delivery
//=============================================================================

Table quotations {
  id varchar [pk]
  quote_number varchar [unique, not null] // QT-YYYY-NNNN
  customer_id varchar [ref: > customers.id]
  customer_name varchar [not null]
  customer_phone varchar [not null]
  model varchar [not null]
  version varchar [not null]
  color varchar [not null]
  base_price decimal [not null]
  accessories text // JSON array
  services text // JSON array
  insurance decimal
  registration_tax decimal
  registration_fee decimal
  other_fees decimal
  discount decimal [default: 0]
  promotion_value decimal [default: 0]
  total_price decimal [not null]
  status quotation_status [not null, default: 'DRAFT']
  valid_until date
  created_by_id varchar [ref: > users.id, not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Indexes {
    (quote_number) [unique, name: 'idx_quotations_number']
    (status) [name: 'idx_quotations_status']
  }
  
  Note: 'TRANSACTION - Báo giá bán xe. Auto-expire sau valid_until'
}

Table test_drives {
  id varchar [pk]
  customer_id varchar [ref: > customers.id, not null]
  model varchar [not null]
  scheduled_date date [not null]
  scheduled_time varchar [not null]
  status test_drive_status [not null, default: 'SCHEDULED']
  sales_consultant_id varchar [ref: > users.id, not null]
  feedback text
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Lịch lái thử xe'
}

Table vins {
  id varchar [pk]
  vin_number varchar [unique, not null]
  model varchar [not null]
  version varchar [not null]
  color varchar [not null]
  year int [not null]
  status vin_status [not null, default: 'AVAILABLE']
  arrival_date date
  allocated_to_contract_id varchar [ref: > contracts.id]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Indexes {
    (vin_number) [unique, name: 'idx_vins_number']
    (status) [name: 'idx_vins_status']
  }
  
  Note: 'MASTER - VIN inventory. Status: AVAILABLE → ALLOCATED → SOLD'
}

Table contracts {
  id varchar [pk]
  contract_number varchar [unique, not null] // CT-YYYY-NNNN
  quotation_id varchar [ref: > quotations.id, not null]
  customer_id varchar [ref: > customers.id, not null]
  vin_id varchar [ref: > vins.id]
  total_amount decimal [not null]
  deposit_amount decimal [not null]
  remaining_amount decimal [not null]
  payment_method payment_method
  contract_date date [not null]
  delivery_date date
  status varchar [not null, default: 'ACTIVE'] // ACTIVE, COMPLETED, CANCELLED
  created_by_id varchar [ref: > users.id, not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Hợp đồng mua xe. Tạo từ Quotation APPROVED'
}

Table deposits {
  id varchar [pk]
  receipt_number varchar [unique, not null] // DP-YYYY-NNNN
  customer_id varchar [ref: > customers.id]
  customer_name varchar [not null]
  contract_id varchar [ref: > contracts.id]
  contract_number varchar
  amount decimal [not null]
  payment_method payment_method [not null]
  status deposit_status [not null, default: 'PAID']
  notes text
  received_by_id varchar [ref: > users.id, not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Phiếu thu tiền đặt cọc'
}

Table pds_checklists {
  id varchar [pk]
  contract_id varchar [ref: > contracts.id, not null]
  vin_id varchar [ref: > vins.id, not null]
  exterior_check text // JSON checklist
  interior_check text // JSON checklist
  mechanical_check text // JSON checklist
  documentation_check text // JSON checklist
  photos text // JSON array of URLs
  inspector_id varchar [ref: > users.id, not null]
  customer_signature varchar // Image URL
  inspector_signature varchar // Image URL
  delivery_date date
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Pre-Delivery Service checklist'
}

//=============================================================================
// MODULE 4: SERVICE - Appointments, Repair Orders, Service Quotes
//=============================================================================

Table service_quotes {
  id varchar [pk]
  quote_number varchar [unique, not null] // SQ-YYYY-NNNN
  customer_id varchar [ref: > customers.id, not null]
  vehicle_info text [not null] // JSON: model, plateNumber, vin, mileage
  services text [not null] // JSON array of service items
  parts text [not null] // JSON array of parts
  total_labor decimal [not null]
  total_parts decimal [not null]
  sub_total decimal [not null]
  vat decimal [not null]
  total_amount decimal [not null]
  status varchar [not null, default: 'DRAFT'] // DRAFT, SENT, APPROVED, RO_CREATED
  advisor_id varchar [ref: > users.id, not null]
  expiry_date date
  notes text
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Báo giá dịch vụ sửa chữa/bảo dưỡng'
}

Table service_appointments {
  id varchar [pk]
  customer_id varchar [ref: > customers.id, not null]
  vehicle_info text [not null] // JSON
  service_type varchar [not null]
  scheduled_date date [not null]
  scheduled_time varchar [not null]
  status service_appointment_status [not null, default: 'SCHEDULED']
  advisor_id varchar [ref: > users.id, not null]
  bay_number varchar
  notes text
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Lịch hẹn dịch vụ'
}

Table repair_orders {
  id varchar [pk]
  ro_number varchar [unique, not null] // RO-YYYY-NNNN
  appointment_id varchar [ref: > service_appointments.id]
  customer_id varchar [ref: > customers.id, not null]
  vehicle_info text [not null] // JSON
  mileage int
  fuel_level varchar
  customer_complaints text
  inspection_notes text
  status repair_order_status [not null, default: 'PENDING']
  advisor_id varchar [ref: > users.id, not null]
  technician_id varchar [ref: > users.id]
  bay_number varchar
  estimated_completion timestamp
  actual_completion timestamp
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Indexes {
    (ro_number) [unique, name: 'idx_ro_number']
    (status) [name: 'idx_ro_status']
  }
  
  Note: 'TRANSACTION - Lệnh sửa chữa (Repair Order)'
}

Table ro_line_items {
  id varchar [pk]
  ro_id varchar [ref: > repair_orders.id, not null]
  item_type varchar [not null] // SERVICE, PART
  item_code varchar [not null]
  item_name varchar [not null]
  quantity decimal [not null]
  unit_price decimal [not null]
  total_price decimal [not null]
  created_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Chi tiết RO (services + parts)'
}

Table work_logs {
  id varchar [pk]
  ro_id varchar [ref: > repair_orders.id, not null]
  technician_id varchar [ref: > users.id, not null]
  work_description text [not null]
  hours_spent decimal
  status varchar [not null] // STARTED, IN_PROGRESS, COMPLETED
  photos text // JSON array
  notes text
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Nhật ký công việc của KTV'
}

Table qc_checklists {
  id varchar [pk]
  ro_id varchar [ref: > repair_orders.id, not null]
  checklist_items text [not null] // JSON array
  photos text // JSON array
  qc_result varchar [not null] // PASS, FAIL
  qc_by_id varchar [ref: > users.id, not null]
  rework_notes text
  created_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Kiểm tra chất lượng sau sửa chữa'
}

//=============================================================================
// MODULE 5: PARTS - Inventory, Purchase Orders, Stock Movements
//=============================================================================

Table parts {
  id varchar [pk]
  part_number varchar [unique, not null]
  name varchar [not null]
  description text
  category varchar [not null]
  quantity int [not null, default: 0]
  min_stock int [not null, default: 10]
  max_stock int [not null, default: 100]
  unit_price decimal [not null]
  cost_price decimal [not null]
  supplier_id varchar [ref: > suppliers.id]
  location varchar // Warehouse location
  status varchar [not null, default: 'ACTIVE'] // ACTIVE, INACTIVE
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Indexes {
    (part_number) [unique, name: 'idx_parts_number']
    (category) [name: 'idx_parts_category']
  }
  
  Note: 'MASTER - Phụ tùng. Quantity cập nhật qua StockMovement'
}

Table suppliers {
  id varchar [pk]
  code varchar [unique, not null]
  name varchar [not null]
  contact_person varchar
  phone varchar
  email varchar
  address text
  payment_terms varchar
  status varchar [not null, default: 'ACTIVE']
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'MASTER - Nhà cung cấp phụ tùng'
}

Table stock_movements {
  id varchar [pk]
  part_id varchar [ref: > parts.id, not null]
  type stock_movement_type [not null]
  quantity int [not null]
  reference_type varchar // PO, RO, ADJUSTMENT
  reference_id varchar
  notes text
  user_id varchar [ref: > users.id, not null]
  created_at timestamp [not null, default: `now()`]
  
  Indexes {
    (part_id) [name: 'idx_stock_movements_part']
    (created_at) [name: 'idx_stock_movements_date']
  }
  
  Note: 'TRANSACTION - Nhập xuất kho. Append-only, không được xóa'
}

Table purchase_orders {
  id varchar [pk]
  po_number varchar [unique, not null] // PO-YYYY-NNNN
  supplier_id varchar [ref: > suppliers.id, not null]
  status purchase_order_status [not null, default: 'DRAFT']
  order_date date [not null]
  expected_delivery_date date
  actual_delivery_date date
  total_amount decimal [not null]
  notes text
  created_by_id varchar [ref: > users.id, not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Đơn mua hàng phụ tùng'
}

Table po_line_items {
  id varchar [pk]
  po_id varchar [ref: > purchase_orders.id, not null]
  part_id varchar [ref: > parts.id, not null]
  quantity int [not null]
  unit_price decimal [not null]
  total_price decimal [not null]
  received_quantity int [default: 0]
  created_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Chi tiết đơn mua hàng'
}

Table stock_takes {
  id varchar [pk]
  session_number varchar [unique, not null] // ST-YYYY-NNNN
  session_date date [not null]
  status varchar [not null, default: 'IN_PROGRESS'] // IN_PROGRESS, COMPLETED
  counted_by_id varchar [ref: > users.id, not null]
  approved_by_id varchar [ref: > users.id]
  notes text
  created_at timestamp [not null, default: `now()`]
  completed_at timestamp
  
  Note: 'TRANSACTION - Phiên kiểm kê kho'
}

Table stock_take_items {
  id varchar [pk]
  stock_take_id varchar [ref: > stock_takes.id, not null]
  part_id varchar [ref: > parts.id, not null]
  system_quantity int [not null]
  actual_quantity int [not null]
  variance int [not null]
  notes text
  created_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Chi tiết kiểm kê từng phụ tùng'
}

//=============================================================================
// MODULE 6: INSURANCE - Contracts & Claims
//=============================================================================

Table insurance_contracts {
  id varchar [pk]
  contract_number varchar [unique, not null] // INS-YYYY-NNNN
  customer_id varchar [ref: > customers.id, not null]
  vehicle_id varchar // Reference to customer's vehicle
  insurance_type varchar [not null] // COMPREHENSIVE, THIRD_PARTY
  insurance_company varchar [not null]
  policy_number varchar [not null]
  premium_amount decimal [not null]
  coverage_amount decimal [not null]
  start_date date [not null]
  end_date date [not null]
  status insurance_contract_status [not null, default: 'ACTIVE']
  notes text
  created_by_id varchar [ref: > users.id, not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Hợp đồng bảo hiểm xe'
}

Table insurance_claims {
  id varchar [pk]
  claim_number varchar [unique, not null] // CLM-YYYY-NNNN
  contract_id varchar [ref: > insurance_contracts.id, not null]
  incident_date date [not null]
  incident_type varchar [not null] // ACCIDENT, THEFT, FIRE, etc.
  incident_description text [not null]
  claim_amount decimal [not null]
  approved_amount decimal
  status insurance_claim_status [not null, default: 'SUBMITTED']
  documents text // JSON array of document URLs
  notes text
  reviewed_by_id varchar [ref: > users.id]
  reviewed_at timestamp
  paid_at timestamp
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Yêu cầu bồi thường bảo hiểm'
}

//=============================================================================
// MODULE 7: ACCOUNTING - Invoices, Payments, Financial Reports
//=============================================================================

Table invoices {
  id varchar [pk]
  invoice_number varchar [unique, not null] // INV-YYYY-NNNN
  customer_id varchar [ref: > customers.id, not null]
  invoice_type varchar [not null] // SALES, SERVICE
  reference_id varchar // Contract ID or RO ID
  invoice_date date [not null]
  due_date date [not null]
  sub_total decimal [not null]
  vat decimal [not null]
  total_amount decimal [not null]
  paid_amount decimal [default: 0]
  status varchar [not null, default: 'UNPAID'] // UNPAID, PARTIAL, PAID
  notes text
  created_by_id varchar [ref: > users.id, not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Indexes {
    (invoice_number) [unique, name: 'idx_invoices_number']
    (status) [name: 'idx_invoices_status']
  }
  
  Note: 'TRANSACTION - Hóa đơn bán hàng/dịch vụ'
}

Table payments {
  id varchar [pk]
  payment_number varchar [unique, not null] // PAY-YYYY-NNNN
  invoice_id varchar [ref: > invoices.id, not null]
  payment_date date [not null]
  amount decimal [not null]
  payment_method payment_method [not null]
  reference_number varchar // Bank transfer ref
  notes text
  received_by_id varchar [ref: > users.id, not null]
  created_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Thanh toán hóa đơn'
}

Table transactions {
  id varchar [pk]
  transaction_date date [not null]
  type transaction_type [not null]
  account_code varchar [not null]
  description text [not null]
  debit decimal [default: 0]
  credit decimal [default: 0]
  reference_type varchar // INVOICE, PAYMENT, etc.
  reference_id varchar
  created_by_id varchar [ref: > users.id, not null]
  created_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Giao dịch kế toán (Journal Entry)'
}

Table fixed_assets {
  id varchar [pk]
  asset_code varchar [unique, not null]
  asset_name varchar [not null]
  category varchar [not null]
  acquisition_date date [not null]
  acquisition_cost decimal [not null]
  useful_life_years int [not null]
  depreciation_method varchar [not null] // STRAIGHT_LINE, DECLINING_BALANCE
  accumulated_depreciation decimal [default: 0]
  net_book_value decimal [not null]
  location varchar
  status varchar [not null, default: 'ACTIVE'] // ACTIVE, DISPOSED
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'MASTER - Tài sản cố định'
}

Table depreciation_schedules {
  id varchar [pk]
  asset_id varchar [ref: > fixed_assets.id, not null]
  period_month varchar [not null] // YYYY-MM
  depreciation_amount decimal [not null]
  accumulated_depreciation decimal [not null]
  net_book_value decimal [not null]
  created_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Lịch khấu hao hàng tháng'
}

Table tax_declarations {
  id varchar [pk]
  declaration_number varchar [unique, not null]
  tax_type varchar [not null] // VAT, CIT, PIT
  period varchar [not null] // YYYY-MM or YYYY-QQ
  taxable_amount decimal [not null]
  tax_amount decimal [not null]
  status varchar [not null, default: 'DRAFT'] // DRAFT, FILED, PAID
  filed_date date
  payment_date date
  created_by_id varchar [ref: > users.id, not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'TRANSACTION - Khai báo thuế'
}

//=============================================================================
// SUPPORTING ENTITIES - Master Data
//=============================================================================

Table vehicle_models {
  id varchar [pk]
  model_code varchar [unique, not null]
  model_name varchar [not null]
  category varchar // SUV, SEDAN, HATCHBACK
  base_price decimal [not null]
  status varchar [not null, default: 'ACTIVE']
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'MASTER - Danh mục model xe Honda'
}

Table accessories {
  id varchar [pk]
  accessory_code varchar [unique, not null]
  accessory_name varchar [not null]
  category varchar
  price decimal [not null]
  status varchar [not null, default: 'ACTIVE']
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'MASTER - Danh mục phụ kiện'
}

Table services_catalog {
  id varchar [pk]
  service_code varchar [unique, not null]
  service_name varchar [not null]
  category varchar [not null] // MAINTENANCE, REPAIR, DIAGNOSIS
  labor_hours decimal [not null]
  labor_rate decimal [not null]
  status varchar [not null, default: 'ACTIVE']
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp [not null, default: `now()`]
  
  Note: 'MASTER - Danh mục dịch vụ'
}
